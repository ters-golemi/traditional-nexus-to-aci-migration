! Nexus Core Switch 1 Configuration
! Device: Nexus 9000 Series
! Role: Core Layer L3 Routing
! vPC Peer: core-02

version 9.3(10)
hostname core-01

! Management
username admin password 5 $5$CHANGE_ME role network-admin
ip domain-lookup

! vPC Configuration
feature vpc
vpc domain 100
  peer-switch
  peer-keepalive destination 192.168.100.2 source 192.168.100.1
  peer-gateway
  auto-recovery

! Routing Protocols
feature ospf
feature bgp
feature interface-vlan

! OSPF Configuration
router ospf 1
  router-id 10.0.0.1
  network 10.0.0.0/8 area 0.0.0.0
  network 172.16.0.0/16 area 0.0.0.0

! BGP Configuration
router bgp 65001
  router-id 10.0.0.1
  address-family ipv4 unicast
    network 10.0.0.0/8
    network 172.16.0.0/16
  neighbor 10.1.1.1
    remote-as 65002
    address-family ipv4 unicast

! VLANs for different tiers
vlan 10
  name WEB_TIER
vlan 20
  name APP_TIER
vlan 30
  name DB_TIER
vlan 40
  name MGMT
vlan 50
  name DMZ
vlan 100
  name INFRASTRUCTURE
vlan 110-119
  name APPLICATION_VLANS
vlan 200
  name STORAGE

! SVI Interfaces
interface Vlan10
  description WEB Tier Gateway
  ip address 192.168.10.1/24
  hsrp 10
    preempt
    priority 110
    ip 192.168.10.254

interface Vlan20
  description APP Tier Gateway
  ip address 192.168.20.1/24
  hsrp 20
    preempt
    priority 110
    ip 192.168.20.254

interface Vlan30
  description DB Tier Gateway
  ip address 192.168.30.1/24
  hsrp 30
    preempt
    priority 110
    ip 192.168.30.254

! Physical Interfaces to Aggregation Layer
interface Ethernet1/1
  description To AGG-01 Eth1/1
  switchport mode trunk
  switchport trunk allowed vlan 10,20,30,40,50,100,110-119,200
  channel-group 1 mode active

interface Ethernet1/2
  description To AGG-01 Eth1/2
  switchport mode trunk
  switchport trunk allowed vlan 10,20,30,40,50,100,110-119,200
  channel-group 1 mode active

interface Ethernet1/3
  description To AGG-02 Eth1/1
  switchport mode trunk
  switchport trunk allowed vlan 10,20,30,40,50,100,110-119,200
  channel-group 2 mode active

interface Ethernet1/4
  description To AGG-02 Eth1/2
  switchport mode trunk
  switchport trunk allowed vlan 10,20,30,40,50,100,110-119,200
  channel-group 2 mode active

! Port-Channels to Aggregation Layer
interface port-channel1
  description vPC to AGG-01
  switchport mode trunk
  switchport trunk allowed vlan 10,20,30,40,50,100,110-119,200
  vpc 1

interface port-channel2
  description vPC to AGG-02
  switchport mode trunk
  switchport trunk allowed vlan 10,20,30,40,50,100,110-119,200
  vpc 2

! vPC Peer-Link
interface Ethernet1/47
  description vPC Peer-Link to Core-02
  switchport mode trunk
  channel-group 100 mode active

interface Ethernet1/48
  description vPC Peer-Link to Core-02
  switchport mode trunk
  channel-group 100 mode active

interface port-channel100
  description vPC Peer-Link
  switchport mode trunk
  vpc peer-link

! Management Interface
interface mgmt0
  ip address 192.168.100.1/24

! Logging and Monitoring
logging server 192.168.100.10
snmp-server community public ro
snmp-server host 192.168.100.10 traps version 2c public

! NTP
ntp server 192.168.100.20